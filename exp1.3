#include <iostream>
#include <vector>
#include <stack>
#include <cstdlib>
#include <ctime>
#include <algorithm>

using namespace std;

int largestRectangleArea(vector<int>& heights) {
    stack<int> stk;
    int maxArea = 0;
    int n = heights.size();
    
    for (int i = 0; i < n; ++i) {
        while (!stk.empty() && heights[i] < heights[stk.top()]) {
            int height = heights[stk.top()];
            stk.pop();

            int width = stk.empty() ? i : (i - stk.top() - 1);
            maxArea = max(maxArea, height * width);
        }
        stk.push(i); 
    }
    while (!stk.empty()) {
        int height = heights[stk.top()];
        stk.pop();
        
        int width = stk.empty() ? n : (n - stk.top() - 1);
        maxArea = max(maxArea, height * width);
    }
    
    return maxArea;
}

vector<int> generateRandomHeights() {
    int size = rand() % 100000 + 1; 
    vector<int> heights(size);
    for (int i = 0; i < size; ++i) {
        heights[i] = rand() % 10001;
    }
    return heights;
}

int main() {
    srand(time(0));

    cout << "===== 示例测试 =====" << endl;
    vector<int> example1 = {2, 1, 5, 6, 2, 3};
    cout << "示例1输入: [2,1,5,6,2,3]，最大面积: " << largestRectangleArea(example1) << endl;  
    vector<int> example2 = {2, 4};
    cout << "示例2输入: [2,4]，最大面积: " << largestRectangleArea(example2) << endl;

    cout << "\n===== 随机数据测试（10组） =====" << endl;
    for (int i = 0; i < 10; ++i) {
        vector<int> heights = generateRandomHeights();
        int area = largestRectangleArea(heights);
        cout << "第" << i+1 << "组: "
             << "长度=" << heights.size() << ", "
             << "前3个高度=";
        for (int j = 0; j < min(3, (int)heights.size()); ++j) {
            cout << heights[j] << " ";
        }
        cout << "...，最大面积=" << area << endl;
    }
    
    return 0;
}
